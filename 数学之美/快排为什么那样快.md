## 0. 前言

知道这个理论是在[TopLanguage](http://groups.google.com/group/pongba)上用的一次讨论，先是g9转了[David MacKay的一篇文章](http://groups.google.com/group/pongba/msg/f95aa12feb4dfd67)，然后引发了牛人们的一场[关于信息论的讨论](https://groups.google.com/forum/#!topic/pongba/KKw54CIr7PI)。Anyway，正如g9很久以前在Blog里面所[说](http://blog.csdn.net/g9yuayon/archive/2007/04/22/1574518.aspx)的：

> 有时候无知是福。俺看到一点新鲜的科普也能觉得造化神奇。刚下读Gerald Jay Sussman（[SICP](http://mitpress.mit.edu/sicp/)作者）的文章，[Building Robust Systems - an essay](http://groups.csail.mit.edu/mac/classes/symbolic/spring07/readings/robust-systems.pdf)，竟然心如小鹿乱撞，手心湿润，仿佛第一次握住初恋情人的手。

而看到MacKay的这篇文章我也有这种感觉——以前模糊的东西忽然有了深刻的解释，一切顿时变得明白无比。原来看问题的角度或层面能够带来这么大的变化。再一次印证了越是深刻的原理往往越是简单和强大。

这篇文章相当于MacKay[原文](http://users.aims.ac.za/~mackay/sorting/sorting.html)的白话文版。MacKay在原文中用到了信息论的知识，后者在我看来并不是必需的，尽管计算的时候方便，但与本质无关。所以我用大白话解释了一遍。

## 1. 猜数字

我们先来玩一个猜数字的游戏：我心里默念一个1~64之间的数，你来猜（你只能问答案是“是”或“否”的问题）。为了保证不论在什么情况下都能以尽量少的次数猜中，你应该采取什么策略呢？很显然，二分法。先猜是不是位于1~32之间，排除掉一半的可能性，然后对区间继续二分。这种策略能够保证无论数字怎么跟你捉迷藏，都能在log_2{n}次以内猜中。用算法的术语来说就是它的下界是最好的。

我们再来回顾一下这个游戏所蕴含的本质：为什么这种策略具有最优下界？答案也很简单，这个策略是平衡的。反之吐过策略不是平衡的，比如问是不是在1~10之间，那么一旦发现不是在1~10之间的话就会剩下比N/2更多的可能性需要去考察了。

[徐宥](https://blog.youxu.info/)在讨论中提到，这种策略的本质可以概括成“让未知世界无机可乘”。它是没有“弱点的”，答案的任何一个分支都是等概率的，反之，一旦某个分支蕴含的可能性更多，当情况落到那个分支上的时候你就郁闷了。比如猜数字游戏最糟糕的策略就是一个一个的猜：是1吗？是2吗？...因为这种猜法最差的情况下需要64次才能猜对，下界非常糟糕。二分搜索为什么好，就是因为它每次都将可能性排除一半并且无论如何都能排除一半（它是最糟情况下表现最好的）。

## 2. 称球

12个小球，其中有一个是坏球。有一架天平。需要你用最少的称重次数来确定哪个小球是坏的并且它到底是轻还是重。

这个问题是一道流传已久的智力题。网络也有很多讲解。还有泛化到N个球的情况下的严格证明。也有零星的一些地方提到从信息论的角度来看待最优解法。本来我一直以为这道题目除了试错之外没有其他高妙的思路了，只能一个个方法试，并尽量从结果中寻找信息，然后看看哪种方案最少。

然后，实际上它的确有其他的思路，一个更本质的思路，而且根本用不着信息论这么拗口的知识。

我们先回顾一下猜数字游戏，为了保证任何情况下以最少次数猜中，我们的策略是每次都排除恰好一半的可能性。类比到称球问题上：坏球可能是12个球中的任意一个，这就是12种可能性；而其中每种可能性下坏球可能轻也可能中。于是“坏球是哪个球，是轻是重”这个问题的答案就有12x2=24种可能性。现在我们用天平来称球，就等同于对这24种可能性发问，由于天平的输出结果有三种“平衡、左倾、右倾”，这就相当于我们的问题有三个答案，即可以将所有的可能性切成三分，根据猜数字游戏的启发，我们应当尽量让这三个分支概率均等，即平均切分所有的可能性为三等份。如此一来的话一次称量就可以将答案的可能性缩减为原来的三分之一，三次就能缩减为1/27。而总共才有24种可能性，所以理论上是完全可以3次称出来的。

如何称的指导原则有了，构造一个称的策略就不是什么太困难的事情了。首先不妨解释一下为什么最直观的乘法不是最优的——6、6称：在6、6称的时候，天平平衡的可能性为0。刚才说了，最优策略应该使得天平三种状态的概率均等，这样才能三等份答案的所有可能性。

为了更清楚的看待这个问题，我们不妨假设有6个球，来考虑一下3、3称和2、2称的区别：

在未称之前，一共有12种可能性：1轻、1重、2轻、2重、...、6轻、6重。现在讲1、2、3号放在左边，4、5、6放在右边3、3称了之后，不失一般性假设天平左倾，那么小球的可能性就变成了原来的一半（6种）：1重、2重、3重、4轻、5轻、6轻。即这种称法能排除一半可能性。

现在再来看2、2称法，即1、2放左边，3、4放右边，剩下的5、6不称，放一边。假设结果是天平平衡。那么可能性剩下——4种：5重、5轻、6重、6轻。假设天平左倾，可能性也剩下4种：1重、2重、3轻、4轻。右倾和左倾的情况类似。总之，这种称法，不管天平结果如何，情况都被我们缩小到了原来的三分之一！我们充分利用了“天平的结果状态可能有三种”这个条件来三等分所有可能性，而不是二等分。

说到这里，剩下的事情就很简单了：第二步称法，只要记着这样一个指导思想——你选择的乘法必须使得当天平平衡的时候答案剩下的可能性和天平左倾（右倾）的时候答案剩下的可能性一样多。实际上，这等同于你得选择一种称法，使得天平输出三种结果的概率是均等的，因为天平输出某个结果的概率就等同于所有支持这个结果（左倾、右倾、平衡）的答案可能性的和，并且答案的每个可能性都是等概率的。

